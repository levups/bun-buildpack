#!/usr/bin/env bash

set -e -o pipefail

BUILD_DIR=${1:-}
CACHE_DIR=${2:-}
ENV_DIR=${3:-}

echo "-----> Installing Bun"
export BUN_INSTALL=$HOME/.bun
curl -fsSL https://bun.sh/install | bash

echo "-----> Exporting profile environment"
command -v bun

mkdir -p $BUILD_DIR/.profile.d
echo "export BUN_INSTALL=\$HOME/.bun" >> $BUILD_DIR/.profile.d/bun_buildpack.sh
echo "export PATH=\$BUN_INSTALL/bin:\$PATH" >> $BUILD_DIR/.profile.d/bun_buildpack.sh

source $BUILD_DIR/.profile.d/bun_buildpack.sh
command -v bun
